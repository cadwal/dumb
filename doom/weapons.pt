/* DUMB: A Doom-like 3D game engine.
 *
 * doom/weapons.pt: Weapons.
 * Copyright (C) 1999 by Kalle Niemitalo <tosi@stekt.oulu.fi>
 * Copyright (C) 1998 by Josh Parsons <josh@coombs.anu.edu.au>
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation; either version 2 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program; if not, write to the Free Software
 * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA 02111,
 * USA.
 */

/**
 **  Weapons
 **/

/* the weapons:
   WepSel lets us select and use it as a weapon
   Shoots is the missile proto
   Ammo is the gettable to use up
   Shooter tells DUMB to shoot rather than hurl
   PickupMessage <string> should make it say "You got the shotgun!"
   or whatever.
   Sound is a sound to make when used
*/

#define StickToFloor  Mass 1000 YMoveOnly


/* phasetables for the player's weapon */

#define _OverlaySprite(name)
#define _ContSound  Sound

PhaseTable Fist
  Default Duration 100msec
  Default Sprite "PUNG"

  Phase IDLE    "A"  Goto IDLE

  Default NoSigs
  Phase PUNCH   "A"  SigShoot Sound DSPUNCH
  Phase -       "B"
  Phase -       "C"
  Phase -       "D"  Melee
  Phase -       "C"
  Phase -       "B"  Goto IDLE


PhaseTable HeldChainsaw
  Default Duration 200msec

  Phase IDLE    "C"
  Phase -       "D"
  Phase -       "C"
  Phase -       "D"
  Phase -       "C"
  Phase -       "D"  _ContSound DSSAWIDL Goto IDLE

  Default NoSigs Duration 320msec
  Phase SAW     "A"  SigShoot Melee Sound DSSAWFUL
  Phase -       "B"  Melee
  Phase -       "A"  Melee /* enough time for DSSAWFUL to play? */
  Phase -       "B"  Melee
  Phase -       "A"  Duration 10msec Sigs Goto IDLE


PhaseTable HeldPistol
  Default Duration 120msec

  Phase IDLE    "A"  Goto IDLE

  Default NoSigs
  Phase SHOOT   "B"  SigShoot Shoot Sound DSPISTOL _OverlaySprite("PISFA0")
  Phase -       "C"
  Phase -       "D"
  Phase -       "E"
  Phase -       "D"  Goto IDLE


PhaseTable HeldShotgun
  Default Duration 200msec

  Phase IDLE    "A"  Goto IDLE

  Default NoSigs
  Phase SHOOT   "A"  SigShoot Sound DSSHOTGN _OverlaySprite("SHTFA0")
  Phase -       "A"  Shoot _OverlaySprite("SHTFB0")
  Phase -       "B"
  Phase -       "C"  Sound DSSGCOCK
  Phase -       "D"
  Phase -       "C"
  Phase -       "B"  Goto IDLE


PhaseTable HeldSuperShotgun
  Default Duration 200msec

  Phase IDLE    "A"  Goto IDLE

  Default NoSigs
  Phase SHOOT   "A"  SigShoot Sound DSDSHTGN _OverlaySprite("SHT2I0")
  Phase -       "A"  Shoot _OverlaySprite("SHT2J0")
  Phase -       "B"
  Phase -       "C"
  Phase -       "D"  Sound DSSGCOCK
  Phase -       "E"
  Phase -       "F"
  Phase -       "G"
  Phase -       "H"  Goto IDLE


PhaseTable HeldChaingun
  Default Duration 150msec

  Phase IDLE    "A"  Goto IDLE

  Phase SHOOT   "B"  NoSigs Shoot _OverlaySprite("CHGFB0") Sound DSPISTOL SigShoot
  Phase -       "A"  Shoot _OverlaySprite("CHGFA0") Sound DSPISTOL Goto IDLE


PhaseTable HeldRocketLauncher
  Default Duration 200msec

  Phase IDLE    "A"  Goto IDLE

  Default Duration 60msec
  Default NoSigs
  Phase SHOOT   "A"  _OverlaySprite("MISFA0") SigShoot
  Phase -       "A"  _OverlaySprite("MISFB0")
  Phase -       "A"  _OverlaySprite("MISFC0") Sound DSRLAUNC
  Phase -       "A"  _OverlaySprite("MISFD0") Shoot
  Phase -       "B"  Duration 500msec Goto IDLE


PhaseTable HeldPlasmaRifle
  Default Duration 40msec

  Phase IDLE    "A"  Goto IDLE

  Phase SHOOT   "A"  NoSigs Sprite "PLSF" Sound DSPLASMA SigShoot
  Phase -       "B"  NoSigs Sprite "PLSF" Shoot
  Phase -       "B"  Duration 50msec Sprite "PLSF"

  Phase COCK    "B"  NoSigs Duration 300msec Goto IDLE


PhaseTable HeldBFG
  Default Duration 350msec

  Phase IDLE    "A"  Goto IDLE

  Default NoSigs
  Phase SHOOT   "B"  Duration 200msec SigShoot
  Phase -       "B"  _OverlaySprite("BFGFA0") Sound DSBFG
  Phase -       "B"  _OverlaySprite("BFGFB0")
  Phase -       "C"  Shoot
  Phase -       "B"
  Phase -       "A"  Duration 500msec Goto IDLE


/* protos for weapon bogus-objects(tm) */

/* here's how it works: objects with the Bogus keyword in their proto
   entries always follow the player around, face the same way, and never
   collide with anything.  They are invisible to the renderer, but are
   drawn onto the players view after the renderer has finished. */

Proto Fist 991
  Sprite "PUNG"
  AimArc 45deg
  Size 32 56
  Bogus
  NoHurtOwner
  Damage 1

Proto BerserkFist
  Phases Fist
  Sprite "PUNG"
  AimArc 45deg
  Size 32 56
  Bogus
  NoHurtOwner
  Damage 20

Proto HeldChainsaw
  Sprite "SAWG"
  AimArc 45deg
  Size 40 56
  Bogus
  NoHurtOwner
  Damage 2 TurnOwner

Proto HeldPistol
  Sprite "PISG"
  AimArc 10deg
  Size 32 56
  Bogus Shooter
  NoHurtOwner
  Shoots Bullet

Proto HeldShotgun
  Sprite "SHTG"
  AimArc 10deg
  Size 32 56
  Bogus Shooter
  NoHurtOwner
  Shoots Bullet
  ShootMany 6 5deg

Proto HeldChaingun
  Sprite "CHGG"
  AimArc 10deg
  Size 32 56
  Bogus Shooter
  NoHurtOwner
  Shoots Bullet
  ShootMany 1 10deg

Proto HeldSuperShotgun
  Sprite "SHT2"
  AimArc 10deg
  Size 32 56
  Bogus Shooter
  NoHurtOwner
  Shoots Bullet
  ShootMany 10 15deg 15deg

Proto HeldPlasmaRifle
  Sprite "PLSG"
  AimArc 10deg
  Size 32 56
  Bogus
  NoHurtOwner
  Shoots PlasmaBall

Proto HeldBFG
  Sprite "BFGG"
  AimArc 20deg
  Size 32 56
  Bogus
  NoHurtOwner
  Shoots BFGBall

Proto HeldRocketLauncher
  Sprite "MISG"
  AimArc 10deg
  Size 32 56
  Bogus
  Shoots Missile

/* now gettable entries for weapons */

Gettable Fist
  Initial 1
  DefaultMaximum 1
  WepSel
  WeaponNumber 1
  Bogotype Fist

Gettable Berserk
  Icon "PSTRA0"
  IconPos 80 6
  Initial 0
  DefaultMaximum 1
  OneMapOnly
  WepSel
  WeaponNumber 1
  ReplaceWeapon Fist
  Bogotype BerserkFist

Gettable Chainsaw
  Initial 0
  DefaultMaximum 1
  WepSel
  WeaponNumber 1
  ReplaceWeapon Fist
  Bogotype HeldChainsaw

Gettable Pistol
  Initial 1
  DefaultMaximum 1
  WepSel
  WeaponNumber 2
  Bogotype HeldPistol
  Ammo Bullet 1

Gettable Shotgun
  DefaultMaximum 1
  WepSel
  WeaponNumber 3
  Bogotype HeldShotgun
  Ammo Shell 1

Gettable SuperShotgun
  DefaultMaximum 1
  WepSel
  WeaponNumber 3
  Bogotype HeldSuperShotgun
  Ammo Shell 2

Gettable Chaingun
  DefaultMaximum 1
  WepSel
  WeaponNumber 4
  Bogotype HeldChaingun
  Ammo Bullet 1

Gettable RocketLauncher
  DefaultMaximum 1
  WepSel
  WeaponNumber 5
  Bogotype HeldRocketLauncher
  Ammo Rocket 1

Gettable PlasmaRifle
  DefaultMaximum 1
  WepSel
  WeaponNumber 6
  Bogotype HeldPlasmaRifle
  Ammo Cell 1

Gettable BFG
  DefaultMaximum 1
  WepSel
  WeaponNumber 7
  Bogotype HeldBFG
  Ammo Cell 40

/* now the actual proto entries */

Proto Chainsaw 2005
  Sprite "CSAW"
  Phases Mundane
  Size 62 24
  StickToFloor
  PickupMessage N_("You got the chainsaw... Find some meat!")
  PickupSound DSWPNUP
  Gets Chainsaw 1

Proto Berserk 2023
  Sprite "PSTR"
  Phases Mundane
  Size 32 20
  StickToFloor
  PickupMessage N_("You smell blood!")
  PickupSound DSGETPOW
  Gets Health 100
  Gets Berserk 1

Proto Shotgun 2001
  Sprite "SHOT"
  Phases Mundane
  Size 62 12
  StickToFloor
  PickupMessage N_("You got the shotgun!")
  PickupSound DSWPNUP
  Gets Shell 6
  Gets ShotGun 1

Proto SuperShotgun 82
  Sprite "SGN2"
  Phases Mundane
  Size 56 12
  StickToFloor
  PickupMessage N_("You got the super shotgun!")
  PickupSound DSWPNUP
  Gets Shell 6
  Gets SuperShotgun 1

Proto Chaingun 2002
  Sprite "MGUN"
  Phases Mundane
  Size 54 16
  StickToFloor
  PickupMessage N_("You got the chaingun!")
  PickupSound DSWPNUP
  Gets Bullet 20
  Gets Chaingun 1

Proto RocketLauncher 2003
  Sprite "LAUN"
  Phases Mundane
  Size 62 16
  StickToFloor
  PickupMessage N_("You got the rocket launcher!")
  PickupSound DSWPNUP
  Gets Rocket 2
  Gets RocketLauncher 1

Proto PlasmaRifle 2004
  Sprite "PLAS"
  Phases Mundane
  Size 54 16
  StickToFloor
  PickupMessage N_("You got the plasma rifle!")
  PickupSound DSWPNUP
  Gets Cell 40
  Gets PlasmaRifle 1

Proto BFG9000 2006
  Sprite "BFUG"
  Phases Mundane
  Size 61 36
  StickToFloor
  PickupMessage N_("You got the BFG!")
  PickupSound DSWPNUP
  Gets Cell 100
  Gets BFG 1

#undef StickToFloor
#undef _OverlaySprite
#undef _ContSound
