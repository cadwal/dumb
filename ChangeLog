1998-10-21  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Released 0.13.3.

	* ptcomp/ptcomp.c (main): Added cast to make C++ happy.

	* README (Bugs in other software): Gettext bugs are no longer
	being investigated.

	* ptcomp/ptcomp.c (show_help): --output-directory is -d, not -o.
	(main): Changed the deprecated-usage message too.

	* tool/dark2trans.c, tool/mkdfnt.c, test/fixed_bm.c: #include
	<errno.h>.

	* docs/patches/Makefile.am: New file.
	* configure.in (AC_OUTPUT): Added docs/patches/Makefile.

	* docs/maint/indent.pro: Added -TXImage.

	* Makefile.am, configure.in: Compile libdumbworldb only if
	--enable-worldbase is given.
	* acconfig.h: Added DUMB_CONFIG_LDWB.
	* test/Makefile.am: Compile ldltest only if --enable-worldbase was
	given.

	* ptcomp/ptcomp.c (main): --output-directory is -d, not -o.
	* doom/Makefile.am ($(d4d_pt_lumps)): Use -d.
	* htic/Makefile.am ($(h4d_pt_lumps)): Use -d.

1998-10-20  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* TODO: --help and --version are now supported!  Hooray!

	* tool/mknulmap.c, tool/mkdfnt.c: Use getopt_long().

1998-10-18  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* tool/dark2trans.c: Use getopt_long().

	* docs/maint/contrib.html: Converted to HTML 4.0 and reformatted
	with PSGML.

	* docs/maint/source.html: Converted to HTML 4.0 Transitional and
	reformatted with PSGML.

1998-10-17  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* htic/Makefile.am ($(h4d_pt_lumps)): Added -o in ptcomp
	invocation.
	* doom/Makefile.am ($(d4d_pt_lumps)): Here too.

	* ptcomp/ptcomp.c (main): Use getopt_long().

	* xwad/xproto.c (silent): Renamed to sound_flag and inverted
	sense.
	(usage): Renamed to print_help() and mostly rewritten.
	(print_version): New function.
	(main): Use getopt_long().

	* test/ldltest.c: #include "getopt.h", not <getopt.h>.

	* libdumbutil/exitcode.h: New file.

	* libdumbutil/bugaddr.c (program_bug_address): Replaced my address
	with dumb-list.

	* tool/Makefile.am (LDADD): Added ../libmissing/libmissing.a.
	(INCLUDES): Added -I$(top_srcdir)/libmissing.
	* xwad/Makefile.am (LDADD, INCLUDES): Here too.
	* ptcomp/Makefile.am (LDADD, INCLUDES): Here too.
	* dumb/Makefile.am (LDADD, INCLUDES): Here too.
	* test/Makefile.am (LDADD): Added this variable.
	(fixed_bm_LDADD, ldltest_LDADD): Use it.

1998-10-16  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* tool/ppmtodumb.c (mkcmap): Removed parameter.  Use the global
	variable directly.

	* xwad/xwad.c (main): Use getopt_long().

	* tool/wadtool.c (print_help, print_version): New functions.
	(main): Check --help and --version.

	* libdumbutil/bugaddr.c, libdumbutil/bugaddr.h: New files.
	* libdumbutil/confhelp.c (conf_usage): Use them.
	* ptcomp/ptcomp.c (show_help): Use them.
	* test/fixed_bm.c (main): Use them.
	* test/ldltest.c (print_help): Use them.
	* tool/dark2trans.c (print_help): Use them.
	* tool/mkdfnt.c (print_help): Use them.
	* tool/mknulmap.c (print_help): Use them.
	* tool/mkpnames.c (print_help): Use them.
	* tool/ppmtodumb.c (print_help): Use them.

	* tool/ppmtodumb.c: Rewrote argument parsing.
	* tool/mkpnames.c: Rewrote argument parsing.  Check all file
	operations.

	* libdumbutil/copyright.h (struct copyright): Renamed owner to
	holder.

1998-10-09  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* tool/mknulmap.c (print_help, print_version): New functions.
	(main): Use them.

	* configure.in: Check for ggiParseMode() rather than ggiSetMode()
	because older GGI versions had only the latter.

	* tool/mkdfnt.c: Made all exit codes #defines.
	(print_help, print_version): New functions.
	(main): Use them.

	* tool/dark2trans.c (print_help, print_version): New functions.
	(main): Use them.

	* test/ldltest.c (print_help, print_version): New functions.
	(main): Use them.

	* dumb/dumb.c (print_program_version): Use the new copyright
	functions.

	* ptcomp/ptcomp.c (main): Support --help and --version.
	(show_help, show_version): New functions.

	* libdumbutil/copyright.c, libdumbutil/copyright.h: New files.

	* ptcomp/ptcomp.c (main): Remove arbitrary limit on directory name
	length.

1998-09-30  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/video.h, dumb/aalib_video.c, dumb/dos_video.c,
	dumb/dummy_video.c, dumb/ggi_video.c, dumb/linux_video.c,
	dumb/x11_video.c: Added video_dep_name.
	* dumb/dumb.c (print_program_version): Use video_dep_name.  Added
	fancy copyright list.

1998-09-28  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libdumbutil/confhelp.c (conf_usage): Recommend --help rather
	than -?.
	(conf_help, conf_usage): Change return type from void because they
	always returned 1.
	* libdumbutil/confargs.c (conf_args): Treat "--help" just like
	"-?".  Parse "--version".  Return void.  Call exit() directly.
	* dumb/dumb.c (main): Don't check conf_args() return value.

1998-09-27  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* configure.in (Local Variables): Added info-lookup-mode.

1998-08-30  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Released 0.13.2.

	* Makefile.am ($(distdir).lsm): New target.
	(RPMSPEC): Use $(srcdir).
	(EXTRA_DIST): Use $(RPMSTEM).spec instead of $(RPMSPEC).
	(kn-dist): New target.

1998-08-29  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* docs/maint/: New directory.  Moved various files there.
	* configure.in: Added docs/dos and docs/maint directories.

	* docs/discord.txt: New file.
	* docs/Makefile.am (EXTRA_DIST): Added discord.txt.

1998-08-24  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/dumb.c (main): Always log to stdout until the configuration
	has been parsed.
	* libdumbutil/log.c (log_cleanup): Renamed to log_close_all() and
	published.  All callers changed.

	* dumb/gettable.c (rotate_selection): Don't call set_bogot() if
	nothing gets selected.

	* dumb/x11_video.c (keymap_keycode_to_keyname): Added
	GGI-compatible names for pad keys.
	* dumb/keymap.c (keymap_defaults): Changed X11 pad keys from "XK_"
	to "Pad ".

1998-08-23  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* docs/dos/: New directory.
	* docs/dos.txt: Superseded by docs/dos/dos-compile.txt.
	* docs/Makefile.am (EXTRA_DIST): Updated.

Mon Aug 17 16:35:05 1998  Josh Parsons  <josh@coombs.anu.edu.au>

	* dumb/bangbang.c (thing_can_shoot_at): reworked 2S wall
	checking: previously monsters could see right through low
	ceilings and high walls.
	* dumb/levdyn.c (diffchk): workaround for a bug in Doom
	and Heretic .wads, some player start locations have no 
	difficulty level eg. htic E2M8 
	* xwad/choose.c (sb_motion, sb_button): fixed a bug that
	prevented scroll bars from scrolling upwards
	* doom/monsters.pt, htic/monsters.pt: ImmuneToSuch
	sprinkled in appropriate places, more tweaks, esp. to
	lost souls, Heretic's Maulotaur
	* dumb/netplay.h, dumb/netplay.c, dumb/dumb.c: new level
	transitions in network play
	* dumb/thingm.c: fixed a bug causing monsters to always
	shoot, never fight, tweaked turnspeeds somemore, explosives
	w/o hitpoints can never be set off by another explosion
	* dumb/netplay.c (send_one_slaveinit), 
	dumb/levinfo.c (load): fixed bugs that prevented multiplayer 
	games with 3 or more players
	* libdumb/prothingstruct.h: TPH_TINVIS, TPH_WHIRLY, PT_MINE,
	PT_STUCKDOWN, PT_IMMUNETOSUCH, TPH_CHARGE, TPH_RSKIP defined
	* ptcomp/protocomp.c, ptcomp/phasecomp.c: many new keywords
	to match new PT_ and TPH_ flags
	* ptcomp/soundcomp.c (new_sound): make sure that new SoundRec
	is inited to all zeros with memset

1998-08-15  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/dumb.c (main): conf_file is a pointer, not an array.
	* libdumbutil/conffile.c (conf_file_name): Replaces
	find_conf_file().

	* libdumbutil/conffile.c (parse_conf_strings, dequote_conf_string,
	fput_conf_string): New functions to handle quoting.  All strings
	and lists are now quoted and backslashified when saved.
	* TODO (conf): Quoting now done.
	* libdumbutil/strgrow.c, libdumbutil/strgrow.h: New files.

Thu Aug 13 00:19:27 1998  Josh Parsons  <josh@coombs.anu.edu.au>

	* dumb/updthing.c: fixed bug introduced in previous patch,
	causing heretic missiles to be affected by gravity. tweaked
	gravity/floatup acceleration to be more processor-speed 
	independent
	* htic/missiles.pt, htic/monsters.pt: implemented WereDragon,
	Pod

1998-08-08  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/ggi_video.c: Revision 1.6 from Andrew Apted.

	* test/fixed_bm.c: Added copyright notice.
	(rtimer): Don't use SIGVTALRM at all.

	* dumb/unix_net.c (udp_init_station): Moved rs->addr assignment
	inside typecast.

	* dumb/Makefile.am (ggidumb_SOURCES): Included $(keyname_sources).
	* configure.in: Updated GGI check.

Fri Aug  7 16:31:35 1998  Josh Parsons  <josh@coombs.anu.edu.au>

	* libdumb/prothingstruct.h: PT_TAKESECTDMG defined
	* doom/missiles.pt, doom/monsters.pt, htic/missiles.pt,
	htic/monsters.pt: speed and damage tweaks
	* dumb/levdyn.h (ThingDyn): added last_hit_wall field, so
	monsters know when they last crashed into a wall
	* dumb/updthing.c (update_things): maintain last_hit_wall,
	flying monsters fall when they run out of hits, only
	players get hurt by the Patented Doom Fluid
	* dumb/thingm.c (do_strategy): monsters try to dodge out
	of enemy's line of fire, miscellaneous fine tuning

Wed Jul 22 03:06:11 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Released 0.13.1.

	* libmissing/Makefile.am (INCLUDES): Added.

Sat Jul 11 21:43:27 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/dumb.c, xwad/xwad.c, xwad/xproto.c, ptcomp/ptcomp.c,
 	tool/wadtool.c, tool/mknulmap.c, tool/mkpnames.c,
 	tool/dark2trans.c, tool/ppmtodumb.c, tool/mkdfnt.c,
 	test/ldltest.c: Include <locale.h>.
	Reported by Josh Parsons.

	* dumb/dumb.c (main): Use DUMB_CONFIG_DOOM_PATH and
	DUMB_CONFIG_HERETIC_PATH only if they are defined.
  	Patch from Josh Parsons.
	* configure.in: Don't define DUMB_CONFIG_DOOM_PATH and
	DUMB_CONFIG_HERETIC_PATH if the files weren't found.

	* libdumb/linux_sound.c (play_sound): Return right away if fd<0.
	* libdumb/sound_mix.c (sndmix_play_sound, sndmix_calc_frag):
 	assert(sndmix_inited).

Fri Jul  3 19:51:30 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* docs/Install-FAQ: Added Q3: Ppmtodumb dumps core.

	* AUTHORS: Changed Ulf Axelsson's WWW address again.

	* htic/Makefile.am (pt_preprocess): Add "-I$(top_srcdir)".
  	Reported by Josh Parsons.
	* dumb/keymap.c (keymap_defaults): Capitalize "Space".  Patch by
 	Josh Parsons.

Wed Jul  1 20:41:38 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* AUTHORS: Changed Ulf Axelsson's addresses.

	* docs/params.txt: New file.
	* docs/dos.txt: New file.
	* docs/Makefile.am (EXTRA_DIST): Add them.

Tue Jun 30 20:59:19 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* docs/Makefile.am (EXTRA_DIST): Use $(VERSION).
	* docs/dumb-0.13.1.lsm: Updated and renamed.

	* Makefile.am (RPMSPEC, RPMIN): Don't use $(srcdir) yet.
	($(RPMSPEC)): Use automatic variables in the rule.

Mon Jun 29 20:13:03 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/x11_video.c (video_conf): Add --vid-abort-on-error.
	(init_video): Support it.
	(error_abort): New function.
	(untrapped_errh): New variable.
	(trap_errs, untrap_errs): Use untrapped_errh.
	(errh, error_abort): Make extern "C".
	(BEGIN_EXTERN_C, END_EXTERN_C): New macros.

	* docs/indent.pro: Add -TXErrorEvent.

	* dumb/x11_video.c (init_video): Treat BPP=4 as 24-bit.  Patch by
 	Josh Parsons.

	* docs/configure.txt: Doc fix.

	* dumb/x11_video.c (video_conf): Add --vid-sync-io.
	(init_video): Support it.

Sun Jun 28 16:48:14 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libdumbutil/safeio.c (safe_mmap): Add casts for C++ compatibility.
	* libdumbutil/safem.c (safe_strdup): Add casts.
	* libdumbwad/loadlump.c (llinit): Add casts.
	* libdumbwad/wadio.c (add_hashent): Add casts.
	(check_sanity): Signedness fix.
	(load_wad): Add casts.
	(lumpnext): Signedness fix.
	(lumplook): Signedness fix.
	* libdumbwad/wadwr.h (WADWR): Signedness fix.
	* libdumbworldb/loaddoom.c (load_doom_sectors): Add casts.
	(load_doom_vertexes): Add casts.
	(load_doom_linedefs): Add casts.
	(load_doom_things): Add casts.
	* libdumbworldb/observer.c (dwdb_new_observer): Add casts.
	* libdumbworldb/savedoom.c (save_doom_vertexes): Add casts.
	(save_doom_sectors): Add casts.
	(save_doom_sidedefs): Add casts.
	(save_doom_linedefs): Add casts.
	* libdumbworldb/thingsec.c (_dwdb_new_thingsec): Add casts.
	* libdumb/prothing.c (get_sprite_table): Add casts.
	(init_prothings): Add casts.
	* libdumb/texture.c (init_playpal): Add casts.
	(init_pnames): Add casts.
	(reset_texture_lumps): Add casts.
	(guess_sprite_size): Add casts.
	(load_sprite): Add casts.
	(load_flat): Add casts.
	(init_patches): Add casts.
	(get_patch_data): Add casts.
	* dumb/dumb.c (main): Add a const to wadpath.
	* dumb/gettable.c (draw_count): Signedness fix.
	* dumb/levinfo.c (init_levinfo): Add casts.
	* dumb/netplay.c (netplay_poll): Signedness fix.
	* dumb/keymap.c (keymap_set_capacity): Add casts.
	* dumb/keymapconf.c (check_binding): Add casts.
	* dumb/renderc.h (init_renderer): Add casts.
	* dumb/unix_net.c (udp_init_station): Add casts.
	(udp_recpkt): Add casts.
	* dumb/linux_video.c (init_video): Add casts.
	(page, pagev): Make unsigned.
	* dumb/x11_video.c (explicit): Define as xkb_explicit.
	* dumb/unix_net.c (udp_sendpkt): Add cast.
	* xwad/xwad.c (init_instance): Add casts.
	* xwad/disphash.c (add_dh): Add casts.
	* xwad/mapcon.c: #include <stdlib.h>
	* xwad/savemap.c (gc_vers): Add cast.
	(gc_sides): Add cast.
	(gc_sects): Add cast.
	* xwad/xproto.c (init_instance): Add cast.
	* test/ldltest.c (queue_op): Add cast.

	* docs/indent.pro: Add -Tcaddr_t.

	* configure.in: Integrate dosdumb-0.13.0 from Ulf Axelsson.
	* dumb/Makefile.am, libdumb/dos_sound.c, libdumbutil/Makefile.am:
 	Ditto.

	* configure.in (--disable-c): New option.

Fri Jun 19 14:17:39 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Makefile.am (RPMIN): Use $(srcdir).

	* libdumbutil/confdef.h (CONFNB): Rename to CONFB_1.  All callers
 	changed.
	(CONFNS): Rename to CONFB_NS.  All callers changed.
	(CONFS): Remove maximum length parameter.  All callers changed to
 	either leave maxlen out or use CONFS_L instead.
  	(CONFS_L): This is what CONFS used to be.

	* AUTHORS (Andrew Tridgell): Added email address.
	(Ulf Axelsson): Added URL.

	* configure.in (CXX_HACK_CC): Define as $CC if little-endian.
	* libdumbutil/Makefile.am (INCLUDES): Add -I../intl.
	(CC): Define as $(CXX_HACK_CC).
	* libdumbwad/Makefile.am: Here too.
	* libdumbrender/Makefile.am: Here too.
	* dumb/Makefile.am: Here too.
	* xwad/Makefile.am: Here too.
	* ptcomp/Makefile.am: Here too.
	* tool/Makefile.am: Here too.
	* test/Makefile.am (INCLUDES): Already had -I../intl.
	(CC): Define as $(CXX_HACK_CC).

	* rpmspec.m4: Don't undivert -1 to -1.  Removed empty lines from
 	beginning of output.

Thu Jun 18 01:12:57 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Makefile.am ($(RPMSPEC)): Use $(srcdir).
	(MAINTAINERCLEANFILES): Added.

Wed Jun 17 19:16:43 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libmissing/Makefile.am: Don't assign CC.

	* Makefile.am (.PHONY): update-po was update-POTFILES.in.

	* configure.in: Save C-as-C++ command as $CXX_HACK_CC and not
 	directly in $CC.

Sun Jun 14 19:43:20 1998  Josh Parsons <josh@coombs.anu.edu.au>

	* libdumbworldb/dummyvtbl.c: Commented out GCC trickery, 
	as it breaks C++ compilation on bigendian architecture
	* libmissing/Makefile.am: use C even on bigendian arch.

	* Makefile.am: target to build a rpm-style .spec file
	* rpmspec.m4: template for .spec file

	* dumb/dumb.c: use built-in wadpath if none specified

	* configure.in: figure out appropriate built-in wadpath, 
	stash real C compiler name in REALCC for libmissing

	* test/fixed_bm.c: include locale.h

Thu Jun 11 19:17:33 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Released 0.13.0.

	* libdumbutil/align.h: New file.
	* libdumbwad/wadwr.c: Renamed ALIGNMENT to ALIGN_LUMP and moved it
 	to libdumbutil/align.h.
	* tool/mkpnames.c (main): Align TEXTURE1 entries.

Wed Jun 10 20:24:11 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Makefile.am (update-po): Don't ignore libintl.h explicitly.

	* libdumb/linux_sound.c: Use sound_mix.
	* libdumb/mme_sound.c: Use sound_mix.

	* libdumb/sound_mix.h: New file.
	* libdumb/sound_mix.c: New file.

Mon Jun  8 21:47:18 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libdumb/dsound.c: Reindent.
	(play_dsound_local): Update s and ent on redirection.

Sun Jun  7 11:13:34 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libdumb/linux_sound.c (resample_and_sum, poll_sound): Handle
 	AFMT_U8 by filling the fragment with 0x80 and adding signed values
 	to that.

	* acconfig.h (DUMB_CONFIG_SOUND_STEREO, DUMB_CONFIG_SOUND_16BIT):
 	Delete.
	* libdumb/linux_sound.c: Choose bits & channels at runtime.
	* configure.in (dumb_sound_options): Delete.

	* docs/indent.pro: New file.
	* libdumb/linux_sound.c: Reindent with that.

Sat Jun  6 16:37:00 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libdumbutil/confdef.h (CONFENUM_END): New macro.
	* dumb/linux_input.c (mousies): Use CONFENUM_END.
	* dumb/x11_video.c (grab_choices): Use CONFENUM_END.
	* dumb/aalib_video.c (dither_choices): Use CONFENUM_END.

	* libdumbutil/confdef.h (CONFITEM_END): New macro.
	* dumb/aalib_video.c (video_conf): Use CONFITEM_END.
	* dumb/dummy_video.c (video_conf): Use CONFITEM_END.
	* dumb/linux_input.c (input_conf): Use CONFITEM_END.
	* dumb/x11_video.c (video_conf, input_conf): Use CONFITEM_END.
	* dumb/game.c (playconf): Use CONFITEM_END.
	* dumb/dummy_input.c (input_conf): Use CONFITEM_END.
	* dumb/unix_net.c (net_conf): Use CONFITEM_END.
	* dumb/dummy_net.c (net_conf): Use CONFITEM_END.
	* dumb/keymapconf.c (keymapconf): Use CONFITEM_END.
	* dumb/aalib_input.c (input_conf): Use CONFITEM_END.
	* dumb/ggi_video.c (input_conf, video_conf): Use CONFITEM_END.
	* dumb/linux_video.c (video_conf): Use CONFITEM_END.
	* dumb/netplay.c (netplay_conf): Use CONFITEM_END.
	* dumb/dumb.c (mainconf): Use CONFITEM_END.

	* libdumb/sound.h (sound_conf): New.

	* dumb/updmap.c: Use LOG_WARNING.
	* dumb/levinfo.c: Use LOG_WARNING.
	* libdumb/linux_sound.c (init_sound): Use safe_open().
	Internationalize.  Use strerror(errno).
	* libdumbworldb/savedoom.c (dwdb_save_doom): Internationalize.
	* libdumbworldb/del.c (dwdb_del_sector): Use LOG_WARNING.
	* libdumbutil/log.c (struct _LogFile): Rename to struct LogFile.
  	Change type of lvl to enum log_level.  Make cl a pointer and
 	rename it to classes.
	(log_cleanup): Free logs and logs->classes.
	(log_stream): Allocate log->classes dynamically.  Use
 	safe_malloc() and safe_strdup().
	(log_file): Use safe_malloc() and strerror(errno).
	(LogFile): Replace FILE *falloc with unsigned flags and
 	LOGF_CLOSE.
	(add_logfile): New function.
	(log_stream, log_file): Rewrite with add_logfile().
	(do_logfatal): Change perror() text.
	(logfatal, do_logfatal): Exit with EXIT_FAILURE, not 1.
	* libdumbutil/log.h (LOG_FATAL, LOG_BANNER, LOG_ERROR, LOG_INFO,
 	LOG_XINFO, LOG_DEBUG, LOG_ALL): Move to enum log_level.
	(LOG_WARNING): New.

	* libdumb/prothing.c (find_phase_sprite): Return NULL without
 	complaining if neither the proto nor the phase specifies a sprite.

Tue Jun  2 18:09:55 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* docs/dumb-0.13.0.lsm (Copying-policy): Doc fix.

Sun May 31 15:35:17 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* docs/dumb-autoins.el: New file.

	* libdumbutil/dumb-nls.h: New file.

	* configure.in: Bump version to 0.13.0.

	* xwad/controls.h (CTLACTION, CTLPRED, CTLINPUT, CTLOUTPUT): Make
 	functions generated with these static.
	* xwad/xproctls.c, xwad/tchoose.c, xwad/xwadctls.c: Remove static
 	keywords from CTL* definitions.

Sun May 24 19:05:35 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* tool/wadtool.c (verbose_flag): New.
	(catwad, main): Conditionalize "Copying..." messages on
 	verbose_flag and make them more informative.

	* libdumbutil/safem.c (safe_vcalloc): Move filenames to the
 	beginning of error messages.
	(safe_realloc, safe_malloc, safe_calloc): Don't use errno.
	(safe_malloc, safe_calloc): No error if malloc(0)==NULL.
	(safe_strdup): Use safe_malloc() and strcpy() instead of strdup().
	(safe_realloc): Handle size==0 separately.

	* test/ldltest.c: Use libdumbworldb instead of libdumblevel.

Wed May 20 17:04:25 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* configure.in: Update version number to 0.12.3.

Tue May 12 17:03:27 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Released 0.12.2-snapshot.

Mon May 11 13:30:46 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libdumblevel/: Rename to libdumbworldb/.  Rename functions and
	structures accordingly.

	* libdumblevel/dummyvtbl.c: New file.

Sat May  9 10:31:48 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Makefile.am (update-POTFILES.in): Rename to update-po and run
 	make update-po in po/.

	* docs/Install-FAQ: Doc fix.

	* test/Makefile.am (ldltest_LDADD): Add ../libmissing/libmissing.a.
	* libmissing/: New directory.

Fri May  8 13:02:58 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Makefile.am (update-POTFILES.in): New target.
	* docs/source.html: Doc fix.

	* libdumblevel/difficulty.c: New file.

	* libdumblevel/isok.c (dumblevel_isok_thing): New function.

	* test/ldltest.c (enum operation): Add OP_SECTOR_THINGS and
 	OP_THING_SECTORS.
	(parse_args): Support --sector-things and --thing-sectors.
	(parse_long, parse_int): New functions.
	(perform_op): Support OP_SECTOR_THINGS and OP_THING_SECTORS.
	(list_sector_things, list_thing_sectors): New functions.

	* libdumbutil/fixed.h: Include <limits.h>.

	* libdumblevel/findsec.c: New file.
	* libdumblevel/thingsec.c: New file.

	* libdumblevel/initfini.c (dumblevel_init, dumblevel_fini): Thing
 	support.

Thu May  7 18:50:44 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libdumblevel/dumblevel.h (struct dumblevel_sector): Add things
 	pointer.
	(struct dumblevel_thing): Add sectors pointer.
	* libdumblevel/private.h (struct _dumblevel_thingsec): New.
	* libdumbutil/Makefile.am (libdumbutil_a_SOURCES): Move intset.*
	to EXTRA_libdumbutil_a_SOURCES.

Wed May  6 18:10:43 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libdumbutil/Makefile.am (libdumbutil_a_SOURCES): Sort.  Add
 	intset.c and intset.h.
	* libdumbutil/intset.h: New file.
	* libdumbutil/intset.c: New file.

Tue May  5 11:23:06 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* xwad/xwadctls.c: Internationalize.
	* xwad/xwad.c: Internationalize.
	* xwad/xproto.c: Internationalize.
	* xwad/xproctls.c: Internationalize.
	* xwad/tchoose.c: Internationalize.
	* xwad/mapcon.c: Internationalize.
	* xwad/connect.c: Internationalize.
	* tool/wadtool.c: Internationalize.
	* tool/ppmtodumb.c: Internationalize.
	* tool/mkpnames.c: Internationalize.
	(main): Open fin with "r", not "rt".
	* tool/mknulmap.c: Internationalize.
	* tool/mkdfnt.c: Internationalize.
	* tool/dark2trans.c: Internationalize.

Mon May  4 00:33:47 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/Makefile.am (LDADD): Add $(INTLLIBS).

	* libdumbwad/wadio.c (load_wad): Print wh with "%p".

	* ptcomp/token.c: Internationalize.
	* ptcomp/soundcomp.c: Internationalize.
	* ptcomp/ptcomp.c: Internationalize.
	* ptcomp/protocomp.c: Internationalize.
	* ptcomp/phasecomp.c: Internationalize.
	* ptcomp/parm.c: Internationalize.
	* ptcomp/ltcomp.c: Internationalize.
	* ptcomp/licomp.c: Internationalize.
	* ptcomp/gettcomp.c: Internationalize.
	* ptcomp/animcomp.c: Internationalize.
	* libdumbwad/wadwr.c: Internationalize.
	* libdumbwad/wadio.c: Internationalize.
	* libdumbutil/safeio.c: Internationalize.

	* libdumbutil/safeio.c (safe_mmap) [!HAVE_MMAP]: Cast size_t to
 	unsigned long before printing.

	* libdumbutil/log.c: Internationalize.
	* libdumbutil/confhelp.c: Internationalize.
	* libdumbutil/conffile.c: Internationalize.
	* libdumbutil/confeng.c: Internationalize.
	* libdumb/texture.c: Internationalize.
	* libdumb/prothing.c: Internationalize.
	* libdumb/mme_sound.c: Internationalize.
	* libdumb/dsound.c: Internationalize.
	* libdumb/dos_sound.c: Internationalize.

Sun May  3 16:28:10 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/dumb.c (main) [ENABLE_NLS]: Initialize NLS.

	* dumb/renderc.h [i386 && !DEBUG]: Include rendsl86.h instead of
 	rendsl.h.

	* dumb/aalib_input.c: Internationalize.
	* dumb/aalib_video.c: Internationalize.
	* dumb/animtex.c: Internationalize.
	* dumb/bangbang.c: Internationalize.
	* dumb/banner.c: Internationalize.
	* dumb/ctlkey.c: Internationalize.
	* dumb/dos_input.c: Internationalize.
	* dumb/dos_video.c: Internationalize.
	* dumb/dumb.c: Internationalize.
	* dumb/dummy_input.c: Internationalize.
	* dumb/game.c: Internationalize.
	* dumb/gettable.c: Internationalize.
	* dumb/ggi_video.c: Internationalize.
	* dumb/keymap.c: Internationalize.
	* dumb/keymapconf.c: Internationalize.
	* dumb/levdata.c: Internationalize.
	* dumb/levdyn.c: Internationalize.
	* dumb/levinfo.c: Internationalize.
	* dumb/linetype.c: Internationalize.
	* dumb/linux_input.c: Internationalize.
	* dumb/linux_video.c: Internationalize.
	* dumb/netio.c: Internationalize.
	* dumb/netplay.c: Internationalize.
	* dumb/rendcore.h: Internationalize.
	* dumb/renderc.h: Internationalize.
	* dumb/termtype.c: Internationalize.
	* dumb/thinghit.c: Internationalize.
	* dumb/thingm.c: Internationalize.
	* dumb/unix_net.c: Internationalize.
	* dumb/updmap.c: Internationalize.
	* dumb/updthing.c: Internationalize.
	* dumb/vgagl_video.c: Internationalize.
	* dumb/x11_video.c: Internationalize.

	* docs/template.c: New file.

	* AUTHORS: Remove lists of what each person has done.

	* libdumb/texture.c (load_wtex): Don't care about NO_1P_KLUDGE.
  	Instead check pointer alignment.  Patch from Marcus Sundberg.
	* dumb/netio.c (net_bufsend): Cast len to unsigned long for
	printing.  Noticed by Marcus Sundberg.
	* dumb/netplay.c (netplay_poll): Likewise with pktlen and
 	sizeof(slave_info).  Subtract 2 from the sizeof in error message.
	* dumb/x11_video.c [!DUMB_CONFIG_XF86DGA]: Don't define page2ofs,
 	page2line, curpage.
	(video_newframe) [!DUMB_CONFIG_XF86DGA]: Don't check curpage.

Sat May  2 12:50:55 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libdumblevel/loaddoom.c (dumblevel_init_doom): Call
 	load_doom_things().
	(load_doom_things): New function.
	(load_doom_sectors, load_doom_vertexes, load_doom_linedefs): Use
 	LOG_ERROR instead of LOG_FATAL and return early if
 	safe_lookup_lump() fails.
	* libdumblevel/dumblevel.h (struct dumblevel_thing): New.

	* xwad/controls.h (CTLATTR): Always define as ATTR_REGPARM.
	* libdumbutil/fixed.h (FIX_ATTR): Use ATTR_REGPARM regardless of
 	defined(i386).
	* libdumbutil/Makefile.am (fixed_CFLAGS, fixed.o): Remove.
	* acconfig.h: Define ATTR_REGPARM as empty.
	* configure.in: Use DUMB_C_ATTR_REGPARM.
	* acinclude.m4 (DUMB_C_ATTR_REGPARM): New macro.

	* README: Doc fix.

	* libdumb/dos_sound.c: New file.  From Ulf Axelsson
 	<ulf@ore.ims.se>.  Tweak #includes for DUMB 0.12.
	* dumb/dos_video.c: Likewise.
	* libdumbutil/dos_timer.c: Likewise.  Remove CR characters.
	* dumb/dos_input.c: Likewise.
	(init_input) Use LOG_ERROR instead of LOG_FATAL if mouse is not
 	found.
	* dumb/dosinput.c: Remove.
	* dumb/dosvideo.c: Remove.

Fri May  1 23:21:23 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/updmap.c (do_sector_event): Change sector type to 0 on
 	ME_CEILING_TEX and ME_FLOOR_TEX.  Patch from Andrew Apted
 	<ajapted@netspace.net.au>.
	* doom/linetypes.pt (LineType 22): Use FloorTexture, not
 	FloorType.

Thu Apr 30 21:20:55 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* test/fixed_bm.c: Mark translatable strings.  Change
 	conversionless printf() calls to fputs() and putchar().
	(main) [ENABLE_NLS]: Call setlocale(), bindtextdomain() and
 	textdomain().

Wed Apr 29 10:01:15 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* acconfig.h (ENABLE_NLS, HAVE_CATGETS, HAVE_GETTEXT,
 	HAVE_LC_MESSAGES, HAVE_STPCPY, LOCALEDIR): New.
	* acinclude.m4 (AM_GNU_GETTEXT): New macro.
	* test/Makefile.am (LIBS): Define as @INTLLIBS@ @LIBS@.
	* Makefile.am (SUBDIRS): Add intl and po.
	* configure.in: Add internationalization section.
	(AC_OUTPUT): Add intl/Makefile and po/Makefile.in.
	(AC_INIT): Change filename to something newer.

	* po/: New directory.
	* intl/: New directory.
	* ABOUT-NLS: New file.

	* libdumbwad/wadwr.c: Use stdio.
	(ALIGNMENT): New constant.
	(aligned_pos): New function.  Replaces macro tell().
	(wadwr_open): Strdup w->fname and free it on errors.
	(wadwr_close): Free w->fname.

	* libdumbwad/wadio.c (load_wad): Print only 4 first characters
	from the signature.

	* libdumblevel/loaddoom.c (load_doom_vertexes, load_doom_sectors):
 	Use assert().

	* test/Makefile.am (LDADD): Separate to fixed_bm_LDADD and
	ldltest_LDADD.
	* dumb/Makefile.am (LDADD, dependencies): Take libdumblevel.a out.

	* libdumblevel/savedoom.c (save_doom_vertexes, save_doom_sectors):
 	Implement.
	(store_texname, save_doom_sidedefs, save_doom_linedefs, struct
 	savedoom_ctx): New.

Tue Apr 28 18:49:01 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* README: Doc fix.

	* test/ldltest.c (enum operation, perform_op): Add OP_SET_NAME and
 	OP_SET_LONGNAME.
	(struct op_node): Use an union.
	(parse_args): Support --set-name=NAME and --set-long-name=NAME.
	(list_sector_sides): Use dumblevel_isok_sector().
	(difficulty): Initialize to -1.

	* libdumblevel/dumblevel.h (struct dumblevel): Add longname.
	* libdumblevel/prop.c (dumblevel_set_longname): New function.
	* libdumblevel/initfini.c (dumblevel_init, dumblevel_fini): Handle
 	lev->longname.

	* libdumblevel/loaddoom.c (dumblevel_init_doom): Remove DIFFICULTY
	and MULTIPLAYER parameters.

	* libdumblevel/isok.c: New file.

	* libdumblevel/prop.c (dumblevel_set_longname): New function.

	* libdumblevel/savedoom.c: Implement basics.

	* libdumblevel/lineprop.c (dumblevel_set_line_side): Notify observers.
	* libdumblevel/detach.c (_dumblevel_detach_side): Notify
 	observers.
	* libdumblevel/dumblevel.h (enum dumblevel_object_type): Add
 	DUMBLEVEL_OT_LEVEL.

Sun Apr 26 11:07:14 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libdumbutil/safem.c (safe_realloc): Handle p1==NULL separately.

	* libdumblevel/del.c (dumblevel_del_vertex, dumblevel_del_sector,
 	dumblevel_del_side, dumblevel_del_line): Call
 	_dumblevel_before_del().
	* libdumblevel/alloc.c (dumblevel_new_vertex,
 	dumblevel_new_sector, dumblevel_new_side, dumblevel_new_line):
 	Call _dumblevel_after_new().
	* libdumblevel/observer.c: New file.
	* libdumblevel/dumblevel.h: Add observer stuff.

Fri Apr 24 19:39:19 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libdumblevel/doomwad.h: New file.
	* libdumblevel/hexenwad.h: New file.
	* libdumblevel/loaddoom.c: Use doomwad.h instead of
 	libdumbwad/wadstruct.h.

Thu Apr 23 16:38:31 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* test/ldltest.c (queue_op): Rename from add_op_node().
	(parse_args): Extend --version output.

	* acinclude.m4: Add gettext macros and a notice that they aren't
 	used yet.

	* libdumblevel/savedoom.c: New file.

Wed Apr 22 10:59:01 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* test/ldltest.c: Mark translatable strings.

	* dumb/renderc.h (INFINITE_SECTORS): New #define.  Not defined by
 	default.
	* dumb/rendcore.h (do_walls) [INFINITE_SECTORS]: Support them.

Mon Apr 20 14:06:09 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libdumblevel/loaddoom.c (lookup_doom_walltex): Return NULL if
 	name is "" or "-".

	* libdumblevel/initfini.c (init_alloc): Initialize
 	alloc->first_used.

	* test/: New directory.
	* test/fixed_bm.c: Move from tool/.
	* test/ldltest.c: New file.

	* libdumblevel/private.h: New file.
	* libdumblevel/detach.c: New file.
	* libdumblevel/del.c: Maintain doubly-linked lists.
	* libdumblevel/lineprop.c (dumblevel_set_line_side): Detach both
 	old and new sides with no error.

	* Applied dumb-patchsearch.diff from Josh Parsons.
	* libdumbwad/wadio.c (safe_lookup_lump): Look for another start if
 	end-marker occurs before the lump being looked for.

Sun Apr 19 16:04:08 1998  Josh Parsons  <josh@coombs.anu.edu.au>

	* dumb/thinghit.c: Renamed perform() to perform_lta(), and put
	a prototype in dumb/linetype.h

	* dumb/updmap.c: Sectortypes implemented.

	* doom/sectortypes.pt: Entries for all Doom (and Heretic?)
	sectortypes.  Not all are tested.

Sun Apr 19 00:09:33 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* xwad/connect.c (mkvxy) [USE_LIBDUMBLEVEL]: Use
 	dumblevel_new_vertex().
	(mksect, cpysect) [USE_LIBDUMBLEVEL]: Use dumblevel_new_sector().
	(mkside) [USE_LIBDUMBLEVEL]: Use dumblevel_new_side().
	(mkline, mkline2s, cpyline) [USE_LIBDUMBLEVEL]: Use
 	dumblevel_new_line().
	(find_lines_at_vertex, find_sel_lines) [USE_LIBDUMBLEVEL]: Always
 	return 0 until I get this fixed.

	* xwad/xwad.c (init_instance) [USE_LIBDUMBLEVEL]: Use
 	dumblevel_init() instead of arrays.
	(free_instance) [USE_LIBDUMBLEVEL]: Use dumblevel_fini() instead
 	of arrays.
	(load_instance) [USE_LIBDUMBLEVEL]: Use dumblevel_init_doom()
 	instead of direct access.  Use inst->level.vertices[0] instead of
 	inst->ver[0].
	(maxsel) [USE_LIBDUMBLEVEL]: Get counts from libdumblevel.
	* xwad/xwad.h (USE_LIBDUMBLEVEL): New macro.
	(struct AppInstance) [USE_LIBDUMBLEVEL]: Use struct dumblevel
	instead of normal members.

	* xwad/xwadmap.h (GRIDIFY): Always round to nearest multiple of
 	inst->gridsize.

	* libdumblevel/dumblevel.h: New file.
	* libdumblevel/initfini.c: New file.
	* libdumblevel/prop.c: New file.
	* libdumblevel/loaddoom.c: New file.
	* libdumblevel/alloc.c: New file.
	* libdumblevel/del.c: New file.
	* libdumblevel/lineprop.c: New file.

	* dumb/rendcore.h (draw_wall_segment, draw_sky_segment)
 	[USE_RENDERER_DEBUG_FLAGS]: Do that.

	* dumb/render.h (renderer_debug_flags): Declare.
	* dumb/rendcommon.c: New file.
	* dumb/Makefile.am (core_sources): Add rendcommon.c.

	* dumb/render.h (INIT_RENDERER_SPEC, RESET_RENDERER_SPEC,
 	RENDER_SPEC): Rewrite as typedefs INIT_RENDERER_FN,
 	RESET_RENDERER_FN, RENDER_FN.
	* dumb/dumb.c (main): Use the typedefs.

	* dumb/dyncode.h (ThingCode): Add flags member.
	* dumb/dyncode.c (DECL_ENCODE(Thing)): Encode flags.
	(DECL_DECODE(Thing)): Decode flags.
	* dumb/levdyn.h (ThingDyn): Add flags member.
	(THINGDF_NOCLIP): New.
	* dumb/updthing.c (update_things): Check THINGDF_NOCLIP.
	* dumb/game.c (process_input): Add cheat key 5.
	* dumb/netplay.h (PROTOCOL_VERSION): Bump to 2.

Sat Apr 18 15:53:52 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/rendcore.h (do_walls): Don't clip top to pstart2 if the
 	back sector has sky ceiling.
	(draw_wall, do_walls): Don't clip top to pend2 if the front sector
 	has sky ceiling.
	(draw_wall_segment, draw_sky_segment): Change error messages.

	* libdumbworld/, libdumbrender/: New subdirectories.

	* docs/contrib.html: Rewrite contrib.txt in HTML.
	* docs/source.html: Rewrite source.txt in HTML.

Fri Apr 17 18:00:38 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* docs/Makefile.am (EXTRA_DIST): Remove README.textures.  Add
	contrib.txt and source.txt.  Rearrange.

	* docs/README.textures: Remove.

	* docs/configure.txt: Doc fix.

	* docs/contrib.txt: New file.
	* docs/source.txt: New file.
	* README: Doc fix.

	* docs/log-classes: Rewrite.

Thu Apr 16 20:17:03 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* docs/Install-FAQ: New file.
	* docs/Makefile.am (EXTRA_DIST): Add Install-FAQ.

	* xwad/Makefile.am (INCLUDES): Add again.

	* libdumbutil/safeio.c (fname_has_directory): Separate from
 	safe_open_path().  Don't search the path if the filename contains
 	a slash.  Used to check the first character only.  [__MSDOS__]
 	Check for backslash and colon too.

	* configure.in: Update version number to 0.12.2.

Sat Apr 11 09:58:39 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Released 0.12.1.

	* dumb/aalib_input.c (get_input): Never change supports_release.
  	Don't call isupper() and islower() if the event isn't a character.
	(init_input): Initialize supports_release based on current AA-lib
 	keyboard driver flags.

	* libdumbutil/safeio.c, libdumb/prothing.c, dumb/levdyn.c,
 	dumb/updmap.c: Change all occurrences of "???" to "?\?\?" to avoid
 	trigraph interpretation.

	* libdumbutil/safeio.c (safe_open_path): Treat the path as empty
 	if it exists (path!=NULL) but has no directories (path[0]==NULL).

	* dumb/unix_net.c (udp_recpkt): Change type of sialen from int to
	size_t.  Reported by rhogan@mnsi.net.

	* docs/dumb-0.12.1.lsm: Rename.  Doc fix.

	* TODO: Move from docs/TODO.

	* dumb/dumb.c (mainconf): New entries: wadpath, doom-wad,
 	doom2-wad, doom4dum-wad.
	(main): Get IWAD filenames from the configuration system.

	* libdumbwad/wadio.c (WadFile): Make fname a pointer.
	(reset_wad): Free wad->fname.
	(check_sanity): Remove parameter fname.  Use wad->fname instead.
  	Rewrite error messages.
	(load_wad): Get wad->fname from safe_open_path().  Use wad->fname
	in messages.
	(init_iwad, init_pwad): New parameter path[].  All callers changed
	to pass NULL if nothing else.
	* dumb/dumb.c (main): Give cnf_wadpath to init_iwad() and
 	init_pwad().

	* libdumbutil/safeio.h: Include <limits.h>.

	* libdumbwad/wadio.c (O_BINARY): Always define unless already
 	defined, even in __MSDOS__.

	* configure.in: Use DUMB_SYS_SHMAT_RMID and define
 	DUMB_CONFIG_SYS_SHMAT_RMID.
	* acconfig.h (DUMB_CONFIG_SYS_SHMAT_RMID): New.
	* dumb/x11_video.c: Use DUMB_CONFIG_SYS_SHMAT_RMID instead of
 	NO_SHMAT_RMID.

	* libdumbutil/safeio.c (safe_mmap, safe_munmap, safe_read,
 	safe_open, safe_close): Use strerror().
	(safe_open): Give open() a file mode parameter.

	* xwad/savemap.c, xwad/xwad.c: Use HAVE_FORK instead of NO_FORK.
  	* libdumbutil/safeio.c, libdumbwad/wadio.c: Use HAVE_MMAP instead
 	of NO_MMAP.

	* tool/wadtool.c (catwad): Change int i to unsigned lumpnum.

	* doom/Makefile.am (PLAYPAL.lump): Use $(DUMB_CONFIG_DOOM_WAD)
	directly instead of $<.
	* htic/Makefile.am (PLAYPAL.lump): Use $(DUMB_CONFIG_HERETIC_WAD)
	directly instead of $<.

	* docs/TODO: Doc fix.

	* configure.in (CPPFLAGS): Include $X_CFLAGS right here.
	* dumb/Makefile.am, xwad/Makefile.am: Don't refer to X_CFLAGS.

	* README: Nowadays we need Automake 1.3.
	* libdumb/Makefile.am (MKDEP), dumb/Makefile.am (MKDEP),
 	tool/Makefile.am (MKDEP), doom/Makefile.am (CXXCPP),
 	htic/Makefile.am (CXXCPP): Remove.  Not necessary with Automake
 	1.3.

	* dumb/le32_fbrerend.c (fbrerender8, fbrerender16): Move
 	"register" to beginning of declaration.

	* tool/Makefile.am (INCLUDES), ptcomp/Makefile.am (INCLUDES),
	xwad/Makefile.am (INCLUDES), libdumb/Makefile.am (INCLUDES),
	libdumbwad/Makefile.am (INCLUDES), libdumbutil/Makefile.am
	(INCLUDES): Don't use +=.

	* configure.in: Look for doom*.wad instead of doom{,1,2}.wad, and
 	look in $datadir/doom/, $datadir/dumb/, /usr/local/games/lib/,
 	/usr/games/lib/, /usr/local/share/doom/, /usr/share/doom/,
 	/usr/local/share/dumb/ and /usr/share/dumb/ too.  Don't accept
 	doom4dum.wad.  Don't AC_DEFINE_UNQUOTED DUMB_CONFIG_DOOM_WAD.
  	Similarly for heretic*.wad.
	* acconfig.h: (DUMB_CONFIG_DOOM_WAD, DUMB_CONFIG_HERETIC_WAD):
 	Remove.

Wed Apr  8 11:13:15 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Released 0.12.

	* dumb/renderc.h (add_wall_events): Always assign event->texxofs
 	and event->texyofs.  Assign event->sidenum just once.

	* doom/weapons.pt (Gettable BerserkFist): Join with Gettable
	Berserk from doom/gettables.pt.  Make local to level.
	* doom/gettables.pt (Proto Berserk): Get only 1 of Berserk.  Move
 	to doom/weapons.pt.

	* configure.in: Temporarily add $X_CFLAGS to $CPPFLAGS when
 	looking for extension headers.

	* configure.in: Look for the C++ preprocessor.
	* doom/Makefile.am, htic/Makefile.am: Use $(CXXCPP), not $(CPP).

	* tool/dark2trans.c: Wrap #include <ppm.h> in extern "C" if
 	compiling as C++.

	* libdumbutil/safem.c: Use #ifdef HAVE_MMAP, not #ifndef NO_MMAP.
	(safe_vcalloc): Use MAP_NORESERVE if available.  Always use
 	DEV_ZERO if MAP_ANONYMOUS isn't defined.  Compare mmap() result to
 	MAP_FAILED, not NULL.  Use strerror().
	(safe_vfree, safe_realloc): Use "%p" and strerror().
	(safe_malloc, safe_calloc, safe_strdup): Use strerror().

Mon Apr  6 10:04:53 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* doom/monsters.pt (Proto Baron): Increase damage from 2 to 20.
	* doom/missiles.pt (Proto BaronFireBall): Increase damage from 7
 	to 15.

	* doom/Makefile.am, htic/Makefile.am: Make pt_preprocess use
 	$(CPP).

	* ptcomp/: New directory.
	* Makefile.am (SUBDIRS): Add ptcomp.
	* configure.in (AC_OUTPUT): Add ptcomp.
	* tool/ptcomp.c: Move to ptcomp/ptcomp.c.
	* tool/Makefile.am (bin_PROGRAMS): Remove ptcomp.
	* ptcomp/ptcomp.c (main): Use perror().  Return EXIT_FAILURE if
 	failed to open some file.
	* ptcomp/parm.c (speed_units): Change error message.
	(parm_str, parm_msg): Change type of string length to size_t.
	* ptcomp/soundcomp.c (soundcomp): Rename from secomp().

	* libdumb/gettablestruct.h (_spare1): Rename to weaponnumber.
	(_spare2): Split to replaceweapon and _spare2.
	* doom/weapons.pt: Replace _WeaponNumber and _ReplacesWeapon
	macros with keywords WeaponNumber and ReplaceWeapon.
	* tool/ptcomp.c (gettcomp): Support WeaponNumber and ReplaceWeapon.

Sun Apr  5 08:20:22 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* tool/ptcomp.c (gettcomp): Remove dead code.

	* dumb/bangbang.c (thing_shoot): Separate parameter arc to
 	horiz_arc and vert_arc.
	* libdumb/prothingstruct.h (ProtoThing): Separate shootarc to
 	shootarc_h and shootarc_v.
	* tool/ptcomp.c (protocomp): Extra parameter in ShootMany.  Clear
	shootarc_v in ShootPara.
	(parm_arc_opt): New function.
	* doom/weapons.pt (Proto HeldSuperShotgun): Add vertical arc in
 	ShootMany.

	* docs/README.ptcomp: Doc fix.

	* dumb/linetype.h (struct LineTypeOffsets): New structure.
	(ltofs): New variable.

	* libdumb/linetypestruct.h (LineType): Add scrolldx, scrolldy.
	(LT_SCROLL): New macro.
	* tool/ptcomp.c (speed_units): Accept and skip sign in s.
	(ltcomp): Support "Scroll".
	* dumb/linetype.c (init_ltscroll, linetype_ticks_passed): New
 	functions.
	(struct LineTypeOffsets): New structure.
	(ltofs, scrollers, nscrollers): New variables.
	* dumb/dumb.c (main): Call linetype_ticks_passed().

	* doom/linetypes.pt (Floor-W1L-UpNext-TX): Rename to
 	Floor-W1L-UpNext-TXP and change FloorTexture to FloorType.  This
	is used in Doom's E1M5 for a bridge rising from slime.

	* dumb/game.c (process_input): Support switching to previous weapon.
	* dumb/gettable.c (rotate_selection): New parameter DIR.  All
 	callers changed.  Wrap in both directions.

	* docs/dumb-0.12.lsm, docs/FAQ, docs/autoconf: Doc fixes.

	* docs/autoconf: Rename to docs/configure.txt.

	* tool/Makefile.am (bin_PROGRAMS): Install mkpnames.

	* doom/weapons.pt: Add "Phases Fist".

Fri Apr  3 12:27:18 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* configure.in: Make nonexecutable.  Fix gethostbyname() error
 	message.

Thu Apr  2 21:21:38 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* doom/weapons.pt (_ReplacesWeapon): New no-op macro.
	(Proto BerserkFist): New.
	(Gettable Fist): New.
	(Gettable BerserkFist): Rename from BrassKnuckles.  Initial 0.
	Use _ReplacesWeapon.  Change message.
	(Gettable Chainsaw): Use _ReplacesWeapon.

	* doom/weapons.pt (_WeaponNumber): New no-op macro.
	(Gettable BrassKnuckles, Chainsaw, Pistol, Shotgun, SuperShotgun,
	Chaingun, RocketLauncher, PlasmaRifle, BFG): Add weapon numbers.

	* configure.in: Bump version number to 0.12.

1998-04-02  Kalle Niemitalo  <tosi@stekt.oulu.fi>

	* Released 0.12.beta2.

	* acinclude.m4 (DUMB_SCAN_LIBS): New macro.
	* configure.in: Check AC_PATH_X and AC_PATH_XTRA before other
	libraries.  Use -lncurses and x libraries when looking for aalib.
	Look for socket() and gethostbyname() in special libraries.

	* tool/ptcomp.c (parm_dbl): Change return type to double (was int).

	* libdumbutil/endiantypes.h: Don't give an error message about
	non-C++ compilation.  The compiler will do that.
	* dumb/linux_video.c: Don't check if linux is defined.

Thu Apr  2 00:33:19 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/updmap.c (unqueue_all_events): New function.
	* dumb/dumb.c (main): Call unqueue_all_events() before loading
	next level.

	* dumb/dumb.c (game_want_newlvl): Rename parameter to secret.

	* acinclude.m4 (DUMB_MSG_REQUIRE): Rewrite without "if !".

	* configure.in: Remove initial #! /bin/bash (how did it ever get
 	there?)

Wed Apr  1 16:52:42 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* doom/levels.pt (E1M9, E2M9, E3M9, E4M9, MAP32): Make the secret
 	exit (which doesn't really exist but can be taken with a cheat
 	key) lead back to the normal game just like the normal exit.

Tue Mar 31 13:57:21 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Released 0.12.beta1.

	* dumb/dumb.c (main): Apply xmul patch from Marcus Sundberg:
	Test (xmul==1 && ymul==1) instead of ((xmul & ymul) == 1).
  	Allocate rendfb with size real_width/xmul*height*bpp instead of
 	width*height*bpp.  Call init_renderer(), init_draw() and
 	fbrerender() with real_width/xmul instead of real_width.  Check if
 	getlump("WAFFLE")==0.

	* dumb/unix_net.c (udp_init_station): Allow HOST:PORT.  Default to
	cnf_udp_port if PORT is not given.

Mon Mar 30 01:26:08 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/linux_input.c (KALLE_KEYS): New macro.
	(get_input) [KALLE_KEYS]: Use my keys.

	* configure.in: Change version number to 0.12.beta1.

	* dumb/dumb.c (main): Open snapshot.ppm as binary.  (Shouldn't
 	have any effect on POSIX systems)

	* dumb/thinghit.c (perform_666): Move to LowestAdjacentFloor, not
 	HighestAdjacentFloor.

	* dumb/ggi_video.c (handle_ggi_key_event) [KALLE_KEYS]: Check
 	K_ASC* keys (assuming Alt+numpad gives these).

Sun Mar 29 16:47:18 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/ggi_video.c: Add Local Variables section.
	(KALLE_KEYS): New macro.
	(handle_ggi_key_event) [KALLE_KEYS]: Very different keymap.
	(handle_ggi_ptr_event, update_continuous_actions) [KALLE_KEYS]:
 	Strafe with Alt, not Ctrl.

	* docs/ifnames: Remove.
	* docs/Makefile.am (EXTRA_DIST): Remove ifnames.

Sat Mar 28 04:23:58 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* docs/keymap.txt: Almost rewritten.
	* dumb/keymap.c: Move long blurb to docs/keymap.txt.

	* tool/ptcomp.c (phasecomp): Add NoGlow, NoDestroy, Sigs,
 	NoStrategy, NoHeatSeek, NoShoot, NoExplode, NoMelee, NoSpawn2,
 	NoRSpawn2, NoIdle, NoBFGEffect and NoSpawn for use in Default.

	* doom/weapons.pt (PhaseTable HeldChainsaw): Make faster.

	* dumb/keymap.c (keymap_defaults): Add bindings for "k", "j", "h",
	"l", ",", ".", "d", "c" and "Shift".

	* data/WADINFO: Remove as unused.
	* data/: Remove as empty.

	* dumb/aalib_input.c (ticks_shift_held): New variable.
	(SHIFT_KEYCODE): New macro.
	(init_input): Move initialisation of variables here.
	(get_input): Check for shift with isupper() and islower().  Update
	and use ticks_shift_held.

	* dumb/x11_video.c (grab_choices): Make const.

	* dumb/aalib_video.c (mypal): Rename to graypal.
	(USE_FASTRENDER): Rename to ALLOW_FASTRENDER.
	(dither_choices): New array.
	(video_conf): New entries for --vid-fastrender, --vid-bright,
	--vid-contrast, --vid-gamma, --vid-dither and --vid-randomval.
	(cnf_fastrender, cnf_bright, cnf_contrast, cnf_gamma, cnf_dither,
 	cnf_randomval): New macros.
	(aapal, aarp): Define even with ALLOW_FASTRENDER.
	(init_video): Use cnf_* macros instead of constants
	(video_setpal): Always call aa_setpalette().

Fri Mar 27 12:27:27 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/keyname.c, dumb/keyname.h: New files.

	* dumb/dummy_video.c (init_video): Set *real_width.

	* dumb/fbrerend.h: Add include guard.  Include render.h.

	* dumb/keymapconf.h (KEYMAPCONF_DEFS): Remove.
	* dumb/keymapconf.c (keymap_conf): New variable.
	(keymapconf_after_load): Rename from
	keymapconf_interpret_all().  Check if keymap is empty.
	(keymapconf_before_save): Rename from keymapconf_make_all().
	* dumb/x11_video.c (init_input, reset_input): Don't do anything
 	with keymap.
	* dumb/aalib_input.c (init_input, reset_input): Don't do anything
	with keymap.
	* dumb/dumb.c (main): Add keymap and keymapconf calls.

Thu Mar 26 02:13:59 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* configure.in: Add --with-doom-wad and --with-heretic-wad
	options.
	* acconfig.h (DUMB_CONFIG_DOOM_WAD, DUMB_CONFIG_HERETIC_WAD):
	New.
	* doom/Makefile.am: Use DUMB_CONFIG_DOOM_WAD if it is set.

	* Apply Solaris patches from <richardp@scopic.com>:
	* dumb/unix_net.c (udp_init): Add cast to (const char *) in
	setsockopt() call.
	* libdumbutil/safem.c: #define MAP_ANONYMOUS as 0 if not defined
	by headers.
	* xwad/drawmap.c (FRONT, BACK): Add casts to int.

Wed Mar 25 15:43:59 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/aalib_input.c: Use keymap.  Autorelease.

	* */*.[ch]: Replace }; with } where possible.

Wed Mar 18 15:26:41 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/netio.c, dumb/netplay.c: Change #include <strings.h> to
	#include <string.h>.

Mon Mar 16 16:04:24 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* libdumb: New directory.  The intent is to move here those files
	from dumb/ that ptcomp, XWad and XProtoThing need.
	* dumb/texture.c: Move to libdumb/texture.c.
	* dumb/texture.h: Move to libdumb/texture.h.
	* dumb/pastepic.c: Rename to libdumb/pastepic.h.

	* lib: Rename to libdumbutil.  This library contains general
 	functions that DUMB uses but which could be used in other programs
 	too.
	* wad: Rename to libdumbwad.  This library contains WAD file
 	handling functions that DUMB uses but which could be used in other
 	programs too.

	* lib/endian.h: Rename to lib/endiantypes.h to avoid clash with
 	system-defined <endian.h> when -I. is given.

	* Begin automake project.  This version is 0.11.kn.2.

Mon Mar 16 14:05:55 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Synchronize with DUMB 0.11.
	* dumb/dumb.c (VERSION): Update to 0.11.kn.1.
	* docs/CHANGES.Niemitalo: Add notification that 0.11 contains most
	of pre0.11.kn.1.

	* docs/ifnames: Regenerate.

Sun Mar 15 21:09:28 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	This version is pre0.11.kn.2.  Josh has published 0.11 which
 	contains most of pre0.11.kn.1.  Now I'm going to make diffs and
 	merge my changes with it.

	* Makefile.in (TAGS): Build separate TAGS files for tool/ and
 	xwad/ because they have clashing identifiers.  Make TAGS a phony
 	target so it can be updated without deleting it first.
	(distclean): Delete tool/TAGS and xwad/TAGS.

	* lib/conf.c (set_conf, conf_args): Apply patches from Josh.  They
	fix (some of?) the bugs I caused.

	* xwad/connect.c: Add Local Variables section.
	(find_lines_at_vertex, find_sel_lines, crossing_point,
 	cross_lines, cross_sel_lines): New functions.
	* xwad/xwadctls.c, xwad/connect.c (join_lines_at_vertex): Move
 	function to xwad/connect.c.
	(join_lines): Proxy for join_lines_at_vertex().
	(linemode_ctls): New button "Crossing" for line_crossing().  It
 	breaks two lines at the point where they intersect.  WARNING: If
 	the lines are parallel, this may cause division by zero and crash.
	* xwad/xwad.h (join_lines_at_vertex, cross_sel_lines): Declare.

Sat Mar 14 21:06:28 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/dumb.c (VERSION): Update to pre0.11.kn.2.

	* plat/ctlkey_input.c, plat/ctlkey_input.h, plat/keymap.c,
	plat/keymap.h, plat/keymapconf.c, plat/keymapconf.h: Update
	address of Free Software Foundation.  This one was on www.fsf.org
	so it should be current.

	* docs/CHANGES.Niemitalo: Add synchronisation/patch notice to
 	yesterday's changes.

	* xwad/xwadctls.c (del_line): Copy algorithm from del_thing().
	Deleting multiple lines should now work.

	* xwad/xwadctls.c (join_lines_at_vertex): New function.  Its body
	should probably be moved to connect.c.
	(vermode_ctls): New control JoinLines.

Fri Mar 13 16:23:55 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	This version has routines for saving the keymap to .dumbrc and
	loading it back.  Only the X11 input driver uses my keymap system
	so far.  So, if you are using X11, now you can finally edit the
	keymap in the configuration file.

	* Synchronize with DUMB pre0.11 by applying patches from Josh
 	Parsons, the author of DUMB: dumb-0.10a-pre0.11.diff.gz,
 	dumb-configure.in.diff.gz,
 	dumb-pre-0.11-netplay-alignment.diff.gz.

	* dumb/dumb.c (VERSION): Update to "pre0.11.kn.1".

	* dumb/dumb.c (main): Remove "Can't find player" check.  There's
	one in dumb/levdata.c.

	* Makefile.in (Makefile): New target.
	* configure.in (@DUMB_CONFIGURE_WAS_RUN@): New substitution.

	* Makefile.in (DEFS): Separate from PLATFLAGS to avoid telling
 	makedepend about X include directories.
	(DEPFLAGS): New variable.
	(depend): Use DEPFLAGS, not CFLAGS.
	* Makefile.in: Update dependencies.

	* Makefile.in (XDUMB_OBJS): Add plat/keymapconf.o.

	* Makefile.in (distclean): Revise comment.  Rearrange.  Add
 	executables.
	(docs/ifnames): Simplify header.

	* aclocal.m4: New file.  Move feature test macros here from
 	configure.in.
	* Makefile.in (SRCDIST_STUFF): Add aclocal.m4.

	* lib/conf.h: Add Local Variables section.
 	(enum conf_type): New.
	(ConfItem): Separate type from flags.  Rearrange.
	(CI_LIST, CI_INT, CI_STR, CI_BOOL, CI_ENUM): Delete.
	(CONFE, CONFI, CONFS, CONFL, CONFB, CONFNB, CONFNS, CI_NOSAVE):
 	Update.
	(conf_clear_list): Declare.
	* lib/conf.c: Comment many functions.  Add Local Variables section.
	(find_conf_file): Check !s[0].
	(load_conf): Look at type, not flags.
	(modhelp, swhelp, set_conf): Rearrange with switch.
	(lookup_etype): Complain if the word given isn't found in the
 	list.
	(set_conf): Always strdup list entries.
	(conf_clear_list): New function.

	* lib/endian.h (IB): Correct return value.  Was (int)i.

	* plat/ctlkey_input.c (recalc_input): Check if
	UNIT_SPEED==INT_TO_FIXED(1).
	(compress_square_to_circle): Add diagram.

	* plat/keymap.c (keymap_install_defaults): Publish.
	(keymap_init): Don't call keymap_install_defaults().
	(keymap_reset): Don't call keymap_debug_dump().
	(keymap_is_empty, keymap_foreach_binding): New functions.
	(keymap_debug_dump): #if 0.
	* plat/keymap.h (keymap_is_empty, keymap_install_defaults,
	keymap_foreach_binding): Declare.
	* plat/keymapconf.c, plat/keymapconf.h: New files.
	* plat/x11_video.c (input_conf): Include KEYMAPCONF_DEFS.
	(FIRST_KEYMAPCONF_ENTRY): New macro.
	(init_input): Interpret the keyboard configuration and install
	defaults if empty.
	(reset_input): Convert the keymap to lists for saving.

Fri Mar  6 14:18:37 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/dumb.c (VERSION): Update to "0.10a.kn.4".

	* lib/safem.c: Add Local Variables section.
	(safe_strdup): New function.
	* lib/safem.h: Declare safe_strdup().  Change comment.

	* plat/ctlkey_input.c, plat/ctlkey_input.h, plat/keymap.c,
 	plat/keymap.h: Add lengthy license notices.  WARNING: FSF's
	address may be old.

	* plat/ctlkey_input.c (recalc_input): Use x,y right from the
 	beginning, and declare them as fixed-point.

	* plat/keymap.c: Update initial comments.  Perhaps they should be
 	moved to docs/keymap.txt.
	(struct keymap_entry): Rename to struct keymap_binding.  Shuffle
 	contents.
	(struct keymap_default_binding): New structure.
	(keymap_clear_caches): Make public.
	(keymap_install_defaults, keymap_bind_key, keymap_new_binding,
 	keymap_del_binding, keymap_set_capacity): New functions.
	(keymap): Now a pointer to a dynamically allocated array.  The old
 	static list is now called keymap_defaults[].
	(keymap_length, keymap_capacity): New variables.
	(keymap_init): Reset new variables and call
 	keymap_install_defaults(), not keymap_clear_caches().
	(keymap_reset): Free the keymap and its contents.
	(keymap_keycode_to_ctlkey): Rename local variable "p" to
 	"binding".  Complain if keymap_keycode_to_keyname() returns NULL.
	(keymap_clear_caches, keymap_find_keycode, keymap_find_keyname,
 	keymap_debug_dump): Terminate loop on i>=keymap_length, not
 	p->action==CTLKEY_NONE.
	(keymap_press_keycode): Call ctlkey_press() even if
 	ctl==CTLKEY_NONE.
	* plat/ctlkey_input.c (ctlkey_press): Allow key==CTLKEY_NONE.
	* plat/ctlkey_input.h (ctlkey_press): Say that CTLKEY_NONE is
	allowed.
	* plat/keymap.h (keymap_clear_caches, keymap_bind_key): Declare.

	* plat/keymap.c, plat/keymap.h: Separate and document the input
	driver and configuration interfaces.

Thu Mar  5 18:41:00 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/dumb.c (VERSION): Update to "0.10a.kn.3".

	* plat/x11_video.c (handle_crossingevent): Comment out logprintf()
	calls.

	* plat/keymap.c, plat/keymap.h: New files.
	* plat/x11_video.c (handle_keyevent): Replace long switch with a
	call to keymap_press_keycode().
	(init_input): Call keymap_init(), not ctlkey_init().
	(reset_input): Call keymap_reset(), not ctlkey_reset().
	(keymap_keycode_to_keyname): New function.
	* Makefile.in (XDUMB_OBJS): Add plat/keymap.o.

	* Makefile.in (TAGS): New target.
	(distclean): Add TAGS to list of removed files.

	* docs/TODO: Add "Uff!"

	* dumb/updthing.c: Add Local Variables section.
	(update_things): Add "fixed factor" in staircase part.
	* docs/TODO: Remove comment about walking backwards in stairs.

	* plat/ctlkey_input.h: Fix confusing comment.

	* Makefile.in: Rerun make depend after configuration and copy the
 	updated dependencies here.  But remove system header dependencies.
  	Uh.  That was painful and error-prone.  Probably I shouldn't have
 	started that at all.

Thu Mar  5 13:29:14 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Makefile.in (BINARIES): Remove $(GAME).wad.

	* docs/ctlkey.txt: Rename to docs/keymap.txt.

	* plat/x11_video.c: Consistently reindent to tab=3 and remove
 	semicolons after closing braces.
	(enum grab_choice_enum, grab_choices): Rename when-focused to
 	when-pointed.  See comment near handle_crossingevent().
	(handle_keyevent): New function.  Separated from get_input().
	(handle_crossingevent): New function.
	(grab_keys, ungrab_keys): New functions.  Use instead of calling
 	XGrabKeyboard() and XUngrabKeyboard() directly.

	Reasons for all those changes in plat/x11_video.c: I liked
 	--vid-grab-focus because it let me use Alt+arrow keys for strafing
 	without the window manager switching between virtual screens all
 	the time.  But I hated it when I couldn't switch back to Emacs and
 	type.  So I made the switch have three states (never,
 	when-focused, always) with "always" being the default as before.
  	And I renamed the switch to --input-grab-kbd because it affected
 	input rather than video.  But then I got trouble implementing the
 	"when-focused" state, decided to base it on the mouse pointer
 	location instead of the real focus and renamed it to
 	"when-pointed".

	Old option             New option
	--vid-grab-focus 0     --input-grab-kbd never
	N/A                    --input-grab-kbd when-pointed
	--vid-grab-focus 1     --input-grab-kbd always

	* docs/TODO: Add one wish about conf.c.

Wed Mar  4 18:49:00 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/dumb.c (VERSION): Update to "0.10a.kn.2".

	* docs/ctlkey.txt: New file.
	* plat/ctlkey_input.c (ctlkey_name): Rename to ctlkey_names[],
	move near bottom of file and add ugly names.
	(struct ctlkey_namepair): New structure.
	(ctlkey_ugly_name, ctlkey_pretty_name): New functions.
	* plat/ctlkey_input.h (ctlkey_name): Remove.
	(ctlkey_ugly_name, ctlkey_pretty_name): Declare new functions.

	* plat/x11_video.c (video_conf, input_conf): Move "grab-focus"
 	from video_conf[] to input_conf[] and rename it to "grab-kbd".
  	Change all references.  Make it enumerated with three values:
 	never, when-focused, always.
	(grab_worked): Rename to "grabbed".
	(init_video): Set grabbed=1 only if it really worked.

Wed Mar  4 10:34:32 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Synchronize with DUMB 0.10a.  Piece of cake.
	* dumb/dumb.c (VERSION): Update to "0.10a.kn.1".
	* pre-ac/Makefile: Copied from Makefile of DUMB 0.10a.

	* Makefile.in (docs/ifnames): New target.
	* docs/ifnames: Regenerate.

	* docs/#README.netplay#: Remove.

Wed Mar  4 09:41:58 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/dumb.c (VERSION): Update to "0.09.kn.4".  I will not
 	distribute this version because Josh has already released 0.10a.

	* Makefile.in (SRCDIST_STUFF): Replace "Makefile" with "configure
	configure.in Makefile.in".  Divide to two lines with a backslash.
	(distclean): New target.

	* configure.in (--disable-16bit-sound, --disable-stereo-sound):
	New options.
	* docs/autoconf: Documented the new sound options.

Tue Mar  3 14:56:03 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Makefile, pre-ac/Makefile: Move old Makefile to the pre-ac
 	directory.  Instead of using it, you should run configure, which
	produces the Makefile from Makefile.in.
	* Makefile.in: New file.
	* configure: New file.
	* configure.in: New file.

	* docs/autoconf: New file.
	* docs/ifnames: New file.

	* docs/CHANGES.Niemitalo: Add "Rerun make depend" to previous
 	changes.

	* render/render.c (//#define CHK_ACTIVE_COUNT): Remove trailing S
	to make the name match the #ifdefs.  Still commented out however.

Wed Feb 18 16:58:54 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* dumb/dumb.c (VERSION): Update to "0.09.kn.3".
	* docs/CHANGES.Niemitalo: Fix lower-case "version" in yesterday's
 	changes.

	* Makefile: Rerun make depend.

	* doom/weapons.pt: Rearrange to match DOOM weapon numbering.

	* dumb/prothing.h (PT_TURNWHENHITTING): New.
	* dumb/thingm.c (do_melee_damage): Add support for
	PT_TURNWHENHITTING.
	* tool/ptcomp.c (protocomp): Add support for TurnWhenHitting.
	* doom/weapons.pt (Proto HeldChainsaw): Add TurnWhenHitting.

	* doom/gettables.pt (Proto Soulsphere): Gets Health 100, not 200.

	* docs/TODO: Add a few wishes.

	* plat/x11_video.c (init_video): Move shm predeletion to correct
 	place.  It was in the wrong branch of an "if" and the segments
	weren't being deleted at all.  My fault.

	* dumb/texture.c (paste_pict_on_texture, paste_jpatch_on_texture):
	Correct "BBP" to "BPP" in error messages.

	* render/slice86.c (PIXEL_GUARD_VAL): New, copied from slice.c.
	(draw_trans_slice): Change type of "p" from Pixel to TPixel.  Use
 	PIXEL_GUARD_VAL (which is always 255) instead of hex constants.
  	This fixes the bug of partially invisible objects appearing as
	rectangles when BPP>1.
	* render/slice.c: Add comment that slice86.c exists.
	(__draw_transparent_sl): Add comment on unsigned integer overflow
 	behavior specified by C standard.

	* render/slice86.c: Remove semicolons after closing braces and
	excessive trailing newlines.

	* dumb/levdyn.h (THING_MAGIC_JELLYBEAN): Rewrite with offsetof()
 	from <stddef.h>.  WARNING: Network playing not tested.  But it
	should work.

Tue Feb 17 15:56:25 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Synchronize with DUMB 0.09.
	* dumb/dumb.c (VERSION): Update to "0.09.kn.2".

	* dumb/dumb.c (main): Remove my fixed-point looking patch because
 	the looking system seems to have changed.
	* plat/ctlkey_input.c (COMPLEX_LOOKING): New #define.  Not defined
 	by default.
	(ctlkey_press, ctlkey_calc_tick): Add #ifdef COMPLEX_LOOKING.
	(recalc_input): Add #ifdef COMPLEX_LOOKING and assignment inside
 	its #else...#endif.

	* plat/x11_video.c (input_conf): Add entry for use-xkb.
	(use_xkb): No longer a separate variable.
	* tool/ptcomp.c (parm_dbl): Remove.  parm_arc() does a better job.

	* render/rendcore.c (do_walls): My texture-alignment fix didn't
 	work right with transparent textures, just like I feared.  Fixed.

	* plat/x11_video.c (init_video): Remove extra call to
 	XkbSetDetectableAutoRepeat().
	(init_video, init_input): Move call of init_xkb() from
 	init_video() to init_input().

	* tool/ptcomp.c (arc_units): Fix error message.  (was "strange
	timing unit")

	* docs/log-classes: New file.

	* plat/ctlkey_input.c: Add TO DO comment.

Mon Feb 16 00:31:54 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* docs/CHANGES.Niemitalo: Reformat this file to GNU standards.
	Add Local Variables section.

	* dumb/dumb.c (VERSION): Update from 0.06 to 0.06.kn.2.

	* Makefile: Rerun make depend.
	(XDUMB_OBJS): Add plat/ctlkey_input.o.
	* plat/ctlkey_input.c, plat/ctlkey_input.h: New files.
	* plat/x11_video.c: Separate ctlkey stuff as plat/ctlkey_input.c.
	(get_input, init_input, reset_input): Call corresponding ctlkey
 	functions.

	* dumb/dumb.c (main): Convert in.lookup to fixed point and divide
 	it by 8 before dividing it by UNIT_SPEED and passing it to
 	player_apply_lookup().
	* dumb/thingm.c (player_apply_lookup): Change type of parameter
 	LOOKUP from int to fixed and don't divide it by 8.  This allows
 	more precise looking / aiming.

	* lib/log.h: #include <stdarg.h> and <stdio.h>.

	* plat/x11_video.c (NO_XKB, use_xkb, init_xkb): New.
	(get_input): Separate looking and aiming.  They are otherwise
 	alike but when the player releases the look button, the view is
 	automatically centered.  Add CTLKEY_CENTER_VIEW from XK_KP_5 and
 	XK_KP_Begin.

	* tool/ptcomp.c (parm_dbl): New function.
	(gettcomp, protocomp): Angle-ratio parameter to ShootMany is now
 	floating-point to allow 0.5 = full circle.  No changes in output
 	lump format.

Fri Feb 13 22:16:03 1998  Kalle Olavi Niemitalo  <tosi@stekt.oulu.fi>

	* Begin with DUMB 0.06 downloaded from cmbsb78.anu.edu.au.

	* dumb/dumb.c, dumb/levdyn.h, xwad/xwadctls.c: Remove empty lines
 	at end of file.
	* dumb/dumb.c, dumb/levdyn.h, plat/x11_video.c, render/rendcore.c,
 	render/render.c, xwad/xwadctls.c: Add Local Variables sections for
 	emacs.

	* Makefile (BINARIES, XLIBS): Adapt to my system.

	* dumb/dumb.c (main): Change comment to "p = play".  Add "Can't
 	find player" check.

	* x11_video.c (init_video): Mark the shared memory segment for
 	deletion right after attaching to it.  This way it won't be left
 	there when the program crashes.
	(reset_video): No need to delete the shared memory segment second
 	time.  See above.

	* x11_video.c (run_state, strafe_state): Replace with
 	ctlpressed[].
        (get_input): Rewrite keyboard control system.  Now it uses "enum
 	ctlkey" and ctlpressed[] between X keysyms and inp_state.
  	Advantages: easier to add keyboard configuration later; run key
	(shift) works even if pressed after movement key; simpler
 	structure.  Rearrange keys to match those we use here (with
 	dedicated strafe keys in numpad 1 & 3; Alt still works however).
  	Add a square-to-circle compression routine so that diagonal
 	movements aren't any faster than forward ones.  Should rethink
 	this one though... the input state should reflect what the player
 	is trying to do, not what he can do.

	* render/rendcore.c (draw_wall_segment): Converted loop to
	operator % when tex_column < 0.  Previous ways in comments.
	* render/rendcore.c (draw_wall, do_walls): Fixed bug pegging
 	textures to wrong sectors when the floor is higher than adjacent
 	sector's ceiling.  WARNING: should test how well my fix cooperates
 	with transparent textures, objects & sky.
	* render/render.c (Active_wall): Added diagram how
 	p{end,start}{1,2} work.

	* xwad/drawmap.c (line_is_sel): Now returns a bit mask indicating
 	currentness/selection status for each side separately.
	(draw_line): Highlights lines according to bit mask got from
 	line_is_sel().  This is great for clicking sectors and seeing if
 	they are using the correct sides of lines.
	* xwad/xwadctls.c (del_thing): Now uses "packing" algorithm that
 	works faster and better when deleting multiple things.
